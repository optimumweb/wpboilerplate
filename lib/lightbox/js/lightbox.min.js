(function(){var a,b,c;a=jQuery;c=function(){function a(){this.fileLoadingImage="http://firecdn.net/libs/lightbox/images/loading.gif";this.fileCloseImage="http://firecdn.net/libs/lightbox/images/close.png";this.resizeDuration=700;this.fadeDuration=500;this.labelImage="Image";this.labelOf="of"}return a}();b=function(){function b(a){this.options=a;this.album=[];this.currentImageIndex=void 0;this.init()}b.prototype.init=function(){this.enable();return this.build()};b.prototype.enable=function(){var b=this;return a("body").on("click","a[rel^=lightbox], area[rel^=lightbox]",function(c){b.start(a(c.currentTarget));return false})};b.prototype.build=function(){var b,c=this;a("<div>",{id:"lightboxOverlay"}).after(a("<div/>",{id:"lightbox"}).append(a("<div/>",{"class":"lb-outerContainer"}).append(a("<div/>",{"class":"lb-container"}).append(a("<img/>",{"class":"lb-image"}),a("<div/>",{"class":"lb-nav"}).append(a("<a/>",{"class":"lb-prev"}),a("<a/>",{"class":"lb-next"})),a("<div/>",{"class":"lb-loader"}).append(a("<a/>",{"class":"lb-cancel"}).append(a("<img/>",{src:this.options.fileLoadingImage}))))),a("<div/>",{"class":"lb-dataContainer"}).append(a("<div/>",{"class":"lb-data"}).append(a("<div/>",{"class":"lb-details"}).append(a("<span/>",{"class":"lb-caption"}),a("<span/>",{"class":"lb-number"})),a("<div/>",{"class":"lb-closeContainer"}).append(a("<a/>",{"class":"lb-close"}).append(a("<img/>",{src:this.options.fileCloseImage}))))))).appendTo(a("body"));a("#lightboxOverlay").hide().on("click",function(a){c.end();return false});b=a("#lightbox");b.hide().on("click",function(b){if(a(b.target).attr("id")==="lightbox")c.end();return false});b.find(".lb-outerContainer").on("click",function(b){if(a(b.target).attr("id")==="lightbox")c.end();return false});b.find(".lb-prev").on("click",function(a){c.changeImage(c.currentImageIndex-1);return false});b.find(".lb-next").on("click",function(a){c.changeImage(c.currentImageIndex+1);return false});b.find(".lb-loader, .lb-close").on("click",function(a){c.end();return false})};b.prototype.start=function(b){var c,d,e,f,g,h,i,j,k;a(window).on("resize",this.sizeOverlay);a("select, object, embed").css({visibility:"hidden"});a("#lightboxOverlay").width(a(document).width()).height(a(document).height()).fadeIn(this.options.fadeDuration);this.album=[];g=0;if(b.attr("rel")==="lightbox"){this.album.push({link:b.attr("href"),title:b.attr("title")})}else{k=a(b.prop("tagName")+'[rel="'+b.attr("rel")+'"]');for(f=0,j=k.length;f<j;f++){e=k[f];this.album.push({link:a(e).attr("href"),title:a(e).attr("title")});if(a(e).attr("href")===b.attr("href"))g=f}}d=a(window);i=d.scrollTop()+d.height()/10;h=d.scrollLeft();c=a("#lightbox");c.css({top:i+"px",left:h+"px"}).fadeIn(this.options.fadeDuration);this.changeImage(g)};b.prototype.changeImage=function(b){var c,d,e,f=this;this.disableKeyboardNav();d=a("#lightbox");c=d.find(".lb-image");this.sizeOverlay();a("#lightboxOverlay").fadeIn(this.options.fadeDuration);a(".loader").fadeIn("slow");d.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide();d.find(".lb-outerContainer").addClass("animating");e=new Image;e.onload=function(){c.attr("src",f.album[b].link);c.width=e.width;c.height=e.height;return f.sizeContainer(e.width,e.height)};e.src=this.album[b].link;this.currentImageIndex=b};b.prototype.sizeOverlay=function(){return a("#lightboxOverlay").width(a(document).width()).height(a(document).height())};b.prototype.sizeContainer=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this;e=a("#lightbox");f=e.find(".lb-outerContainer");n=f.outerWidth();m=f.outerHeight();d=e.find(".lb-container");j=parseInt(d.css("padding-top"),10);i=parseInt(d.css("padding-right"),10);g=parseInt(d.css("padding-bottom"),10);h=parseInt(d.css("padding-left"),10);l=b+h+i;k=c+j+g;if(l!==n&&k!==m){f.animate({width:l,height:k},this.options.resizeDuration,"swing")}else if(l!==n){f.animate({width:l},this.options.resizeDuration,"swing")}else if(k!==m){f.animate({height:k},this.options.resizeDuration,"swing")}setTimeout(function(){e.find(".lb-dataContainer").width(l);e.find(".lb-prevLink").height(k);e.find(".lb-nextLink").height(k);o.showImage()},this.options.resizeDuration)};b.prototype.showImage=function(){var b;b=a("#lightbox");b.find(".lb-loader").hide();b.find(".lb-image").fadeIn("slow");this.updateNav();this.updateDetails();this.preloadNeighboringImages();this.enableKeyboardNav()};b.prototype.updateNav=function(){var b;b=a("#lightbox");b.find(".lb-nav").show();if(this.currentImageIndex>0)b.find(".lb-prev").show();if(this.currentImageIndex<this.album.length-1){b.find(".lb-next").show()}};b.prototype.updateDetails=function(){var b,c=this;b=a("#lightbox");if(typeof this.album[this.currentImageIndex].title!=="undefined"&&this.album[this.currentImageIndex].title!==""){b.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast")}if(this.album.length>1){b.find(".lb-number").html(this.options.labelImage+" "+(this.currentImageIndex+1)+" "+this.options.labelOf+"  "+this.album.length).fadeIn("fast")}else{b.find(".lb-number").hide()}b.find(".lb-outerContainer").removeClass("animating");b.find(".lb-dataContainer").fadeIn(this.resizeDuration,function(){return c.sizeOverlay()})};b.prototype.preloadNeighboringImages=function(){var a,b;if(this.album.length>this.currentImageIndex+1){a=new Image;a.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){b=new Image;b.src=this.album[this.currentImageIndex-1].link}};b.prototype.enableKeyboardNav=function(){a(document).on("keyup.keyboard",a.proxy(this.keyboardAction,this))};b.prototype.disableKeyboardNav=function(){a(document).off(".keyboard")};b.prototype.keyboardAction=function(a){var b,c,d,e,f;b=27;c=37;d=39;f=a.keyCode;e=String.fromCharCode(f).toLowerCase();if(f===b||e.match(/x|o|c/)){this.end()}else if(e==="p"||f===c){if(this.currentImageIndex!==0){this.changeImage(this.currentImageIndex-1)}}else if(e==="n"||f===d){if(this.currentImageIndex!==this.album.length-1){this.changeImage(this.currentImageIndex+1)}}};b.prototype.end=function(){this.disableKeyboardNav();a(window).off("resize",this.sizeOverlay);a("#lightbox").fadeOut(this.options.fadeDuration);a("#lightboxOverlay").fadeOut(this.options.fadeDuration);return a("select, object, embed").css({visibility:"visible"})};return b}();a(function(){var a,d;d=new c;return a=new b(d)})}).call(this)